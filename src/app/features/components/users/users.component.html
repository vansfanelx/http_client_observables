<!-- Contenedor principal del componente de usuarios -->
<div class="users-container">
  <div class="header-section">
    <h1>ğŸ¯ GestiÃ³n de Usuarios</h1>
    <button (click)="abrirFormularioCrear()" class="btn-crear">
      â• Nuevo Usuario
    </button>
  </div>

  <!-- Mensaje de error si ocurre algÃºn problema -->
  <div *ngIf="error" class="error-message">
    <p>âš ï¸ {{ error }}</p>
  </div>

  <!-- Indicador de carga mientras se obtienen los datos -->
  <div *ngIf="cargando" class="loading">
    <p>â³ Cargando datos...</p>
  </div>

  <!-- Lista de usuarios en tabla -->
  <div *ngIf="!cargando && usuarios.length > 0" class="users-list">
    <div class="table-header">
      <h2>ğŸ“‹ Total de Usuarios: {{ usuarios.length }}</h2>
      <button (click)="cargarUsuarios()" class="btn-refresh" title="Recargar desde API">
        ğŸ”„ Recargar
      </button>
    </div>
    
    <div class="table-container">
      <table class="users-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>ğŸ‘¤ Nombre</th>
            <th>ğŸ“§ Email</th>
            <th>ğŸ“ TelÃ©fono</th>
            <th>ğŸ™ï¸ Ciudad</th>
            <th>ğŸ¢ Empresa</th>
            <th>âš™ï¸ Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let usuario of usuariosPaginados" class="table-row">
            <td>{{ usuario.id }}</td>
            <td class="user-name">{{ usuario.name }}</td>
            <td>{{ usuario.email }}</td>
            <td>{{ usuario.phone }}</td>
            <td>{{ usuario.address?.city }}</td>
            <td>{{ usuario.company?.name }}</td>
            <td class="actions-cell">
              <div class="table-actions">
                <button (click)="cargarUsuario(usuario.id)" class="btn-icon btn-view" title="Ver detalles">
                  ğŸ‘ï¸
                </button>
                <button (click)="abrirFormularioEditar(usuario)" class="btn-icon btn-edit" title="Editar">
                  âœï¸
                </button>
                <button (click)="eliminarUsuario(usuario.id)" class="btn-icon btn-delete" title="Eliminar">
                  ğŸ—‘ï¸
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- PaginaciÃ³n -->
    <div class="pagination" *ngIf="totalPaginas > 1">
      <button 
        class="btn-page" 
        (click)="paginaAnterior()" 
        [disabled]="paginaActual === 1">
        â—€ Anterior
      </button>
      
      <div class="page-numbers">
        <button 
          *ngFor="let pagina of paginas"
          class="btn-page-number"
          [class.active]="pagina === paginaActual"
          (click)="irAPagina(pagina)">
          {{ pagina }}
        </button>
      </div>
      
      <button 
        class="btn-page" 
        (click)="paginaSiguiente()" 
        [disabled]="paginaActual === totalPaginas">
        Siguiente â–¶
      </button>
    </div>

    <div class="pagination-info">
      Mostrando {{ (paginaActual - 1) * itemsPorPagina + 1 }} - 
      {{ Math.min(paginaActual * itemsPorPagina, usuarios.length) }} 
      de {{ usuarios.length }} usuarios
    </div>
  </div>

  </div>

<!-- Modal de Detalles del Usuario -->
<div *ngIf="usuarioSeleccionado" class="modal-overlay" (click)="limpiarSeleccion()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <!-- Header del Modal -->
    <div class="modal-header">
      <h2>ğŸ‘¤ Detalles del Usuario</h2>
      <button (click)="limpiarSeleccion()" class="btn-close-modal" title="Cerrar">âœ–</button>
    </div>
    
    <!-- Contenido del Modal -->
    <div class="modal-body">
      <!-- InformaciÃ³n Personal -->
      <div class="detail-section">
        <h3>ğŸ“‹ InformaciÃ³n Personal</h3>
        <div class="detail-grid">
          <div class="detail-item">
            <span class="detail-label">ID:</span>
            <span class="detail-value">{{ usuarioSeleccionado.id }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Nombre:</span>
            <span class="detail-value">{{ usuarioSeleccionado.name }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Usuario:</span>
            <span class="detail-value">{{ usuarioSeleccionado.username }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Email:</span>
            <span class="detail-value">{{ usuarioSeleccionado.email }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">TelÃ©fono:</span>
            <span class="detail-value">{{ usuarioSeleccionado.phone }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Sitio Web:</span>
            <span class="detail-value">{{ usuarioSeleccionado.website }}</span>
          </div>
        </div>
      </div>

      <!-- DirecciÃ³n -->
      <div class="detail-section">
        <h3>ğŸ“ DirecciÃ³n</h3>
        <div class="detail-grid">
          <div class="detail-item">
            <span class="detail-label">Calle:</span>
            <span class="detail-value">{{ usuarioSeleccionado.address?.street }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Suite:</span>
            <span class="detail-value">{{ usuarioSeleccionado.address?.suite }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Ciudad:</span>
            <span class="detail-value">{{ usuarioSeleccionado.address?.city }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">CÃ³digo Postal:</span>
            <span class="detail-value">{{ usuarioSeleccionado.address?.zipcode }}</span>
          </div>
        </div>
      </div>
      
      <!-- Empresa -->
      <div class="detail-section">
        <h3>ğŸ¢ Empresa</h3>
        <div class="detail-grid">
          <div class="detail-item full-width">
            <span class="detail-label">Nombre:</span>
            <span class="detail-value">{{ usuarioSeleccionado.company?.name }}</span>
          </div>
          <div class="detail-item full-width">
            <span class="detail-label">Frase:</span>
            <span class="detail-value">{{ usuarioSeleccionado.company?.catchPhrase }}</span>
          </div>
          <div class="detail-item full-width">
            <span class="detail-label">BS:</span>
            <span class="detail-value">{{ usuarioSeleccionado.company?.bs }}</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Footer del Modal -->
    <div class="modal-footer">
      <button (click)="limpiarSeleccion()" class="btn-close">Cerrar</button>
    </div>
  </div>
</div>

<!-- Modal de Formulario (Crear/Editar Usuario) -->
<div *ngIf="mostrarFormulario" class="modal-overlay" (click)="cerrarFormulario()">
  <div class="modal-container form-modal" (click)="$event.stopPropagation()">
    <!-- Header del Modal -->
    <div class="modal-header">
      <h2>{{ modoEdicion ? 'âœï¸ Editar Usuario' : 'â• Crear Nuevo Usuario' }}</h2>
      <button (click)="cerrarFormulario()" class="btn-close-modal" title="Cerrar">âœ–</button>
    </div>
    
    <!-- Formulario -->
    <div class="modal-body">
      <form (ngSubmit)="guardarUsuario()" #userForm="ngForm">
        
        <!-- InformaciÃ³n Personal -->
        <div class="form-section">
          <h3>ğŸ“‹ InformaciÃ³n Personal</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="name">Nombre Completo *</label>
              <input 
                type="text" 
                id="name" 
                [(ngModel)]="formularioUsuario.name" 
                name="name" 
                required
                placeholder="Ej: Juan PÃ©rez">
            </div>
            
            <div class="form-group">
              <label for="username">Usuario *</label>
              <input 
                type="text" 
                id="username" 
                [(ngModel)]="formularioUsuario.username" 
                name="username" 
                required
                placeholder="Ej: juanp">
            </div>
            
            <div class="form-group">
              <label for="email">Email *</label>
              <input 
                type="email" 
                id="email" 
                [(ngModel)]="formularioUsuario.email" 
                name="email" 
                required
                placeholder="Ej: juan@example.com">
            </div>
            
            <div class="form-group">
              <label for="phone">TelÃ©fono</label>
              <input 
                type="text" 
                id="phone" 
                [(ngModel)]="formularioUsuario.phone" 
                name="phone"
                placeholder="Ej: 1-770-736-8031">
            </div>
            
            <div class="form-group full-width">
              <label for="website">Sitio Web</label>
              <input 
                type="text" 
                id="website" 
                [(ngModel)]="formularioUsuario.website" 
                name="website"
                placeholder="Ej: ejemplo.com">
            </div>
          </div>
        </div>

        <!-- DirecciÃ³n -->
        <div class="form-section">
          <h3>ğŸ“ DirecciÃ³n</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="street">Calle</label>
              <input 
                type="text" 
                id="street" 
                [(ngModel)]="formularioUsuario.address.street" 
                name="street"
                placeholder="Ej: Kulas Light">
            </div>
            
            <div class="form-group">
              <label for="suite">Suite/Apt</label>
              <input 
                type="text" 
                id="suite" 
                [(ngModel)]="formularioUsuario.address.suite" 
                name="suite"
                placeholder="Ej: Apt. 556">
            </div>
            
            <div class="form-group">
              <label for="city">Ciudad</label>
              <input 
                type="text" 
                id="city" 
                [(ngModel)]="formularioUsuario.address.city" 
                name="city"
                placeholder="Ej: Gwenborough">
            </div>
            
            <div class="form-group">
              <label for="zipcode">CÃ³digo Postal</label>
              <input 
                type="text" 
                id="zipcode" 
                [(ngModel)]="formularioUsuario.address.zipcode" 
                name="zipcode"
                placeholder="Ej: 92998-3874">
            </div>
          </div>
        </div>

        <!-- Empresa -->
        <div class="form-section">
          <h3>ğŸ¢ Empresa</h3>
          <div class="form-grid">
            <div class="form-group full-width">
              <label for="companyName">Nombre de la Empresa</label>
              <input 
                type="text" 
                id="companyName" 
                [(ngModel)]="formularioUsuario.company.name" 
                name="companyName"
                placeholder="Ej: Romaguera-Crona">
            </div>
            
            <div class="form-group full-width">
              <label for="catchPhrase">Frase Corporativa</label>
              <input 
                type="text" 
                id="catchPhrase" 
                [(ngModel)]="formularioUsuario.company.catchPhrase" 
                name="catchPhrase"
                placeholder="Ej: Multi-layered client-server neural-net">
            </div>
            
            <div class="form-group full-width">
              <label for="bs">Business Strategy</label>
              <input 
                type="text" 
                id="bs" 
                [(ngModel)]="formularioUsuario.company.bs" 
                name="bs"
                placeholder="Ej: harness real-time e-markets">
            </div>
          </div>
        </div>
      </form>
    </div>
    
    <!-- Footer del Modal -->
    <div class="modal-footer">
      <button (click)="cerrarFormulario()" type="button" class="btn-cancelar">Cancelar</button>
      <button (click)="guardarUsuario()" type="button" class="btn-guardar">
        {{ modoEdicion ? 'Actualizar' : 'Crear' }}
      </button>
    </div>
  </div>
</div>
